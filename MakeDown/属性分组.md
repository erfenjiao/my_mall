# 属性分组

## 前端组件抽取 && 父子组件交互

### 三级分类后端接口

![1](./图片/属性分组/1.png)

### 属性分组前端

左右布局。左边三级分类，右边查询

![2](./图片/属性分组/2.png)

```
<el-row> 
```



#### 左边三级分类

/views/modules/common/category.vue

el-tree 中，使用catId区分节点，el-tree组件名字叫做menuTree

![4](./图片/属性分组/4.png)



data 数据结构体如下：

![3](./图片/属性分组/3.png)

getMenus()获取三级分类。数据填入menus

![5](./图片/属性分组/5.png)

#### 父子组件

在  attrgroup.vue 中导入组件

![6](./图片/属性分组/6.png)

#### 右边表格

![7](./图片/属性分组/7.png)

###  属性分组功能

#### 1 父子组件通信

当我们点击第三级分类，会在右边出现查询到的属性信息

问题：

怎样让树形组件感知到点击事件？怎样查询，并在attrgroup.vue的前端el-table表格中显示出来？

解决：父子组件通信

父组件：attrgroup.vue

![9](./图片/属性分组/9.png)

引用了category.vue

![8](./图片/属性分组/8.png)

官方文档

![10](./图片/属性分组/10.png)

methods中 三个参数

![11](./图片/属性分组/11.png)

![12](./图片/属性分组/12.png)

#### 2  获取分类属性分组

接口文档：

![13](./图片/属性分组/13.png)

数据库表：

![14](./图片/属性分组/14.png)

后端实现：

![15](./图片/属性分组/15.png)

![16](./图片/属性分组/16.png)

#### 3 新增中的级联选择器

级联选择器

![17](./图片/属性分组/17.png)

前端代码添加级联选择器

![18](./图片/属性分组/18.png)

注意：

##### 注意点1

:options 中使用 categorys 数组



##### 注意点2

设定 :options 的value label childern值，否则不能正确显示出数据



##### 注意点3

第三级分类下没有childern[]集合了，但是还是显示空白

![19](./图片/属性分组/19.png)

CategoryEntity.java 中：添加NON_EMPTY，表示children字段返回时不为空时才带

![20](./图片/属性分组/20.png)



##### 注意点4

catelogId 包括了当前节点和它的父节点Id，但数据库返回时只需要当前节点的 Id

![21](./图片/属性分组/21.png)

![22](./图片/属性分组/22.png)

提交后刷新页面：

子组件给父组件attrgroup.vue发送事件

![23](./图片/属性分组/23.png)

![24](./图片/属性分组/24.png)

父组件

![25](./图片/属性分组/25.png)



##### 注意点5

点击修改，所属分类并没有回显

![26](./图片/属性分组/26.png)

原因：回显是层级关系，之前为了向数据库提交，只保存了当前节点自己的 categoryId ，所以回显就无法显示完整的路径

查看修改按钮代码，点击事件：addOrUpdateHandle

![27](./图片/属性分组/27.png)

此事件调用addOrUpdate组件，给此组件传入id

![28](./图片/属性分组/28.png)



![29](./图片/属性分组/29.png)

![30](./图片/属性分组/30.png)

找到 init 方法，在 dataForm 中添加 catelogPath ，查出完整路径

![31](./图片/属性分组/31.png)

数据中也添加

![32](./图片/属性分组/32.png)

后台中也添加。在AttrGroupEntity.java 中添加

![33](./图片/属性分组/33.png)

添加 findCatelogPath() 方法

![34](./图片/属性分组/34.png)

实现：

![35](./图片/属性分组/35.png)

##### 注意点6

使级联框可搜索

在 <el-cascader> 中添加 filterable
